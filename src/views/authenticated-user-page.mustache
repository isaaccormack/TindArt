<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="/stylesheets/style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>TindArt</title>
  <link rel="icon" type="image" href="../assets/icons8-fire-30.png" />
</head>

{{> header}} {{! This is the header that will be on almost all of the pages }}

<body>
  <h1>{{name}}, this is your profile.</h1>
  <h3>{{city}}, {{province}}</h3>
  <!-- Edit bio button / form dynamically created in below div -->
  <div class="profile">
    <span class="avatar">
      {{#avatar}}
        <img src={{avatar}} class="user-avatar" alt="User Avatar" />
      {{/avatar}}
      {{^avatar}}
        <img src="../assets/icons8-user-30.png" class="user-avatar" alt="User Avatar" />
      {{/avatar}}
      <a href="/upload"><img src="../assets/icons8-user-80.png" class="edit-pencil" alt="Edit" /></a>
    </span>
    <span class="bio">
      <div id="bio">
      </div>
      <p>{{bio}}</p>
      <div id="phone-number">
      </div>
      <p>{{phoneNumber}}</p>
    </span>
  </div>

  <div class="user-owned-photos">
    <h3>
      Your Uploaded Photos <span class="spacer"></span>
      <a href="/upload"><img src="../assets/icons8-user-80.png" class="edit-pencil" alt="Edit" /></a>
    </h3>
    <div class="photo-box">
      <ul>
        {{#photoURLs}}
        <li><img src={{.}} width="200"></a></li>
        {{/photoURLs}}
      </ul>
    </div>
  </div>

  <h4>{{messages.serverError}}</h4>
</body>

<!-- JS for Bio Edit Field  -->
<script>
  document.onload = buildEditBioBtn();

  function buildEditBioBtn() {
    document.getElementById('bio').innerHTML +=
      '<div id="edit-bio">' +
      '<button type="button" onclick="handleEditBioBtnClick(event);">Edit Bio</button>' +
      '{{messages.bioError}}' +
      '</div>';
  }

  function buildEditBioForm() {
    document.getElementById('bio').innerHTML +=
      '<form id="update-bio-form" action="/api/user/updateBio" method="post">' +
      '<input type="submit" hidden="true" />' + // This form field enables form submission when 'enter' is pressed and focus is on textbox
      '<div class="c-form__row">' +
      '<label for="bio-input" class="c-label">Bio</label>' +
      '<input type="text" name="bio" id="bio-input" class="c-input-field" value="" autocorrect="off" maxlength="255" required />' +
      '</div>' +
      '<div class="c-form__row">' +
      '<button class="c-button" onclick="handleCancelEditBioBtnClick(event);" type="submit">Cancel</button>' +
      '</div>' +
      '<div class="c-form__row">' +
      '<button class="c-button" type="submit">Save</button>' +
      '</div>' +
      '</form>'
  }

  function handleEditBioBtnClick(e) {
    e.preventDefault();

    document.getElementById('edit-bio').remove(); // Delete edit bio button on DOM
    buildEditBioForm();
  }

  function handleCancelEditBioBtnClick(e) {
    e.preventDefault();

    document.getElementById('update-bio-form').remove(); // Delete edit bio form on DOM
    buildEditBioBtn();
  }
</script>

<!-- JS for Phone Number Edit Field  -->
<script>
  document.onload = buildEditPhoneNumBtn();

  function buildEditPhoneNumBtn() {
    document.getElementById('phone-number').innerHTML +=
      '<div id="edit-phone-number">' +
      '<button type="button" onclick="handleEditPhoneNumBtnClick(event);">Edit Phone Number</button>' +
      '{{messages.phoneNumberError}}' +
      '</div>';
  }

  function buildEditPhoneNumForm() {
    document.getElementById('phone-number').innerHTML +=
      '<form id="update-phone-number-form" action="/api/user/updatePhoneNumber" method="post">' +
      '<input type="submit" hidden="true" />' + // This form field enables form submission when 'enter' is pressed and focus is on textbox
      '<div class="c-form__row">' +
      '<label for="bio-input" class="c-label">Phone Number</label>' +
      '<input type="tel" name="phoneNumber" id="bio-input" class="c-input-field" value="" autocorrect="off" maxlength="10" required />' +
      '</div>' +
      '<div class="c-form__row">' +
      '<button class="c-button" onclick="handleCancelEditPhoneNumBtnClick(event);" type="submit">Cancel</button>' +
      '</div>' +
      '<div class="c-form__row">' +
      '<button class="c-button" type="submit">Save</button>' +
      '</div>' +
      '</form>'
  }

  function handleEditPhoneNumBtnClick(e) {
    e.preventDefault();

    document.getElementById('edit-phone-number').remove(); // Delete edit phone number button on DOM
    buildEditPhoneNumForm();
  }

  function handleCancelEditPhoneNumBtnClick(e) {
    e.preventDefault();

    document.getElementById('update-phone-number-form').remove(); // Delete edit phone number form on DOM
    buildEditPhoneNumBtn();
  }
</script>

</html>